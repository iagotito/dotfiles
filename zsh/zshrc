# prompt configuration

fpath=($DOTFILES/zsh/prompt $fpath)
autoload -Uz prompt_setup; prompt_setup

# zhistory

setopt PUSHD_IGNORE_DUPS    # Do not store duplicates in the stack.
setopt PUSHD_SILENT         # Do not print the directory stack after pushd or popd.
setopt INC_APPEND_HISTORY
setopt HIST_IGNORE_ALL_DUPS
setopt HIST_SAVE_NO_DUPS
setopt HIST_FIND_NO_DUPS

# zsh directory stack

setopt AUTO_PUSHD           # Push the current directory visited on the stack.
setopt PUSHD_IGNORE_DUPS    # Do not store duplicates in the stack.
setopt PUSHD_SILENT         # Do not print the directory stack after pushd or popd.
alias ds='dirs -v'  # directy stack
                    # 'd' is used to deactivate python venvs (see $DOTFILES/aliases)
for index ({1..9}) alias "$index"="cd +${index}"; unset index

# bd
source $DOTFILES/zsh/plugins/zsh-bd/bd.zsh

# functions

source $DOTFILES/functions

# aliases

source $DOTFILES/aliases
source $DOTFILES/personal-aliases

# Vi mode
bindkey -v
export KEYTIMEOUT=1

# Vim mapping for completion

zmodload zsh/complist
bindkey -M menuselect 'h' vi-backward-char
bindkey -M menuselect 'k' vi-up-line-or-history
bindkey -M menuselect 'l' vi-forward-char
bindkey -M menuselect 'j' vi-down-line-or-history

# asdf

. $HOME/.asdf/asdf.sh

# append completions to fpath
fpath=(${ASDF_DIR}/completions $fpath)
# initialise completions with ZSH's compinit
autoload -Uz compinit; compinit
_comp_options+=(globdots) # With hidden files
source $DOTFILES/zsh/plugins/completion.zsh

# activate the syntax highlighting
# see: https://github.com/zsh-users/zsh-syntax-highlighting
ZSH_HIGHLIGHT_HIGHLIGHTERS=(main brackets pattern)
source $DOTFILES/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh

# starts new terminal with a tmux session and close it when quit tmux
if [ -t 0 ] && [[ -z $TMUX ]] && [[ $- = *i* ]]; then
  exec tmux;
fi

# append snap to PATH
path+=('/snap/bin')

[ -f ~/.fzf.zsh ] && source ~/.fzf.zsh
